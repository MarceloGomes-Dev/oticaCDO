<!doctype html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz Interativo de Óculos</title>
    <script src="/_sdk/element_sdk.js"></script>
    <style>
        body {
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            background: linear-gradient(135deg, #1a202c 0%, #2d3748 50%, #4a5568 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #e2e8f0;
        }

        .intro-screen {
            background: linear-gradient(135deg, #2d3748 0%, #4a5568 100%);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            max-width: 600px;
            width: 90%;
            padding: 60px 40px;
            text-align: center;
            position: relative;
            overflow: hidden;
            border: 1px solid #4a5568;
        }

        .quiz-container {
            background: linear-gradient(135deg, #2d3748 0%, #4a5568 100%);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            max-width: 600px;
            width: 90%;
            padding: 40px;
            text-align: center;
            position: relative;
            overflow: hidden;
            border: 1px solid #4a5568;
            display: none;
        }

        .logo-container {
            margin-bottom: 30px;
        }

        .logo {
            width: 150px;
            height: 150px;
            background-image: url('https://github.com/MarceloGomes-Dev/oticaCDO/blob/main/Logo.png?raw=true');
            background-size: cover;
            background-position: center;
            border-radius: 50%;
            margin: 0 auto 20px;
            animation: logoFloat 3s ease-in-out infinite;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .company-name {
            font-size: 2.5rem;
            font-weight: bold;
            color: #e2e8f0;
            margin-bottom: 10px;
            animation: fadeInUp 1s ease-out 0.5s both;
        }

        .consultant-intro {
            font-size: 1.3rem;
            color: #cbd5e0;
            margin-bottom: 30px;
            animation: fadeInUp 1s ease-out 1s both;
        }

        .consultant-name {
            color: #667eea;
            font-weight: 600;
        }

        .start-button {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 50px;
            font-size: 1.2rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            animation: fadeInUp 1s ease-out 1.5s both;
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.3);
        }

        .start-button:hover {
            transform: translateY(-3px);
            box-shadow: 0 15px 35px rgba(102, 126, 234, 0.4);
        }

        .quiz-header {
            margin-bottom: 30px;
        }

        .quiz-title {
            font-size: 2.5rem;
            font-weight: bold;
            color: #e2e8f0;
            margin-bottom: 10px;
        }

        .welcome-message {
            font-size: 1.1rem;
            color: #cbd5e0;
            margin-bottom: 20px;
        }

        .progress-bar {
            width: 100%;
            height: 8px;
            background: #4a5568;
            border-radius: 4px;
            margin-bottom: 30px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2);
            border-radius: 4px;
            transition: width 0.3s ease;
            width: 0%;
            box-shadow: 0 0 10px rgba(102, 126, 234, 0.5);
        }

        .question-container {
            margin-bottom: 30px;
        }

        .question-number {
            font-size: 0.9rem;
            color: #a0aec0;
            margin-bottom: 10px;
        }

        .question-text {
            font-size: 1.4rem;
            font-weight: 600;
            color: #e2e8f0;
            margin-bottom: 25px;
            line-height: 1.4;
        }

        .options-container {
            display: grid;
            gap: 15px;
        }

        .option-button {
            background: #1a202c;
            border: 2px solid #4a5568;
            border-radius: 12px;
            padding: 20px;
            font-size: 1rem;
            color: #e2e8f0;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: left;
            position: relative;
        }

        .option-button:hover {
            background: #2d3748;
            border-color: #667eea;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.2);
        }

        .option-button.selected {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border-color: #667eea;
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
        }

        .result-container {
            display: none;
            text-align: center;
        }

        .result-title {
            font-size: 2rem;
            font-weight: bold;
            color: #e2e8f0;
            margin-bottom: 20px;
        }

        .recommendation-card {
            background: #1a202c;
            border: 1px solid #4a5568;
            border-radius: 12px;
            padding: 25px;
            margin: 20px 0;
            text-align: left;
        }

        .recommendation-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: #667eea;
            margin-bottom: 10px;
        }

        .recommendation-text {
            color: #cbd5e0;
            line-height: 1.6;
        }

        .discount-banner {
            background: linear-gradient(135deg, #48bb78, #38a169);
            color: white;
            padding: 20px;
            border-radius: 12px;
            margin: 20px 0;
        }

        .discount-title {
            font-size: 1.3rem;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .share-button {
            background: #4299e1;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            margin-top: 10px;
            transition: background 0.3s ease;
        }

        .share-button:hover {
            background: #3182ce;
        }

        .restart-button {
            background: #667eea;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 1rem;
            cursor: pointer;
            margin-top: 20px;
            transition: background 0.3s ease;
        }

        .restart-button:hover {
            background: #5a67d8;
        }

        .fade-in {
            animation: fadeIn 0.5s ease-in;
        }

        .success-screen {
            background: linear-gradient(135deg, #2d3748 0%, #4a5568 100%);
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            max-width: 600px;
            width: 90%;
            padding: 60px 40px;
            text-align: center;
            position: relative;
            overflow: hidden;
            border: 1px solid #4a5568;
            display: none;
        }

        .success-animation {
            font-size: 4rem;
            margin-bottom: 20px;
            animation: bounce 1s ease-in-out;
        }

        .discount-message {
            font-size: 1.5rem;
            color: #48bb78;
            font-weight: bold;
            margin-bottom: 20px;
            animation: fadeInUp 1s ease-out 0.5s both;
        }

        @keyframes logoFloat {

            0%,
            100% {
                transform: translateY(0px);
            }

            50% {
                transform: translateY(-10px);
            }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes bounce {

            0%,
            20%,
            53%,
            80%,
            100% {
                transform: translateY(0);
            }

            40%,
            43% {
                transform: translateY(-30px);
            }

            70% {
                transform: translateY(-15px);
            }

            90% {
                transform: translateY(-4px);
            }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .slide-in {
            animation: slideIn 0.4s ease-out;
        }

        @keyframes slideIn {
            from {
                transform: translateX(30px);
                opacity: 0;
            }

            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        @keyframes pulse {
            0% {
                transform: scale(1);
            }

            50% {
                transform: scale(1.05);
            }

            100% {
                transform: scale(1);
            }
        }

        .completion-animation {
            animation: pulse 0.6s ease-in-out;
        }
    </style>
    <style>
        @view-transition {
            navigation: auto;
        }
    </style>
    <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
    <script src="https://cdn.tailwindcss.com" type="text/javascript"></script>
</head>

<body>
    <div class="intro-screen" id="introScreen">
        <div class="logo-container">
            <div class="logo">
            </div>
        </div>
        <h1 class="company-name">Óticas CDO</h1>
        <p class="consultant-intro">Olá! Eu sou <span class="consultant-name">Iris</span>, sua consultora virtual.<br>
            Posso te ajudar a escolher as melhores lentes que se encaixam no seu perfil.</p><button class="start-button"
            onclick="startQuiz()">Vamos Começar! 🚀</button>
    </div>
    <div class="quiz-container" id="quizContainer">
        <div class="quiz-header">
            <h1 class="quiz-title">Quiz Personalizado de Óculos</h1>
            <p class="welcome-message">Descubra as lentes ideais para você em apenas 10 perguntas!</p>
        </div>
        <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
        </div>
        <div class="question-container" id="questionContainer">
            <div class="question-number" id="questionNumber">
                Pergunta 1 de 10
            </div>
            <h2 class="question-text" id="questionText"></h2>
            <div class="options-container" id="optionsContainer"></div>
        </div>
        <div class="result-container" id="resultContainer">
            <h2 class="result-title">Suas Recomendações Personalizadas</h2>
            <div id="recommendationsContent"></div>
            <div class="discount-banner">
                <div class="discount-title">
                    🎉 Oferta Especial!
                </div>
                <p>Compartilhe seu resultado e ganhe 20% de desconto na sua primeira compra!</p><button
                    class="share-button" onclick="shareResult()">Compartilhar Resultado</button>
            </div><button class="restart-button" onclick="restartQuiz()">Fazer Quiz Novamente</button>
        </div>
    </div>
    <div class="success-screen" id="successScreen">
        <div class="success-animation">
            🎉
        </div>
        <div class="discount-message">
            Parabéns!
        </div>
        <p style="color: #e2e8f0; font-size: 1.2rem; margin-bottom: 20px;">Você ganhou <strong
                style="color: #48bb78;">20% de desconto</strong> na sua primeira compra!</p>
        <p style="color: #cbd5e0; margin-bottom: 30px;">Apresente este cupom em qualquer loja Óticas CDO ou use o código
            <strong>QUIZ20</strong> no site.</p><button class="restart-button" onclick="backToResults()">Voltar aos
            Resultados</button>
    </div>
    <script>
        // Lista de consultores virtuais com sexo definido
        const consultants = {
            female: [
                "Iris", "Luna", "Sofia", "Clara", "Maya", "Lara", "Nina", "Eva", "Zara", "Mia",
                "Ana", "Beatriz", "Camila", "Diana", "Fernanda", "Gabriela", "Helena", "Juliana", "Letícia", "Mariana"
            ],
            male: [
                "Alex", "Bruno", "Carlos", "Diego", "Eduardo", "Felipe", "Gabriel", "Hugo", "Ivan", "João",
                "Leonardo", "Marcos", "Nicolas", "Otávio", "Pedro", "Marcelo", "Samuel", "Thiago", "Victor", "William"
            ]
        };

        // Função para selecionar consultor aleatório
        function getRandomConsultant() {
            const gender = Math.random() > 0.5 ? 'female' : 'male';
            const names = consultants[gender];
            const name = names[Math.floor(Math.random() * names.length)];
            return { name, gender };
        }

        // Configuração padrão
        const selectedConsultant = getRandomConsultant();
        const defaultConfig = {
            company_name: "Óticas CDO",
            consultant_name: selectedConsultant.name,
            consultant_gender: selectedConsultant.gender,
            welcome_message: "Posso te ajudar a escolher as melhores lentes que se encaixam no seu perfil.",
            discount_text: "Compartilhe seu resultado e ganhe 20% de desconto na sua primeira compra!"
        };

        // Estado do quiz
        let currentQuestion = 0;
        let answers = [];
        let userProfile = { ageGroup: '', usesGlasses: '' };

        // Perguntas fixas (primeiras 2)
        const fixedQuestions = [
            {
                id: 1,
                text: "Você se encaixa em qual faixa etária?",
                options: [
                    { text: "Jovem (até 30 anos)", value: "young" },
                    { text: "Adulto (31-50 anos)", value: "young" },
                    { text: "Maduro (51-65 anos)", value: "old" },
                    { text: "Sênior (acima de 65 anos)", value: "old" }
                ]
            },
            {
                id: 2,
                text: "Qual sua relação atual com óculos?",
                options: [
                    { text: "Sim, uso sempre", value: "uses" },
                    { text: "Sim, mas só para leitura", value: "uses" },
                    { text: "Não uso, mas sinto necessidade", value: "doesnt_use" },
                    { text: "Não uso e não sinto necessidade", value: "doesnt_use" }
                ]
            }
        ];

        // Perguntas condicionais baseadas no perfil
        const conditionalQuestions = {
            young_uses: [
                { text: "Qual atividade você mais faz no dia a dia?", options: ["Trabalho no computador", "Estudo", "Atividades ao ar livre", "Uso de celular/tablet"] },
                { text: "Que tipo de problema visual você tem?", options: ["Miopia  (Dificuldade para enxergar de longe)", "Hipermetropia  (Dificuldade para enxergar de perto)", "Astigmatismo  (Visão borrada ou distorcida em todas as distâncias)", "Presbiopia  (Dificuldade para focar de perto)"] },
                { text: "Com que frequência você usa dispositivos digitais?", options: ["Mais de 8 horas por dia", "4-8 horas por dia", "2-4 horas por dia", "Menos de 2 horas"] },
                { text: "Você sente desconforto visual ao final do dia?", options: ["Sempre", "Frequentemente", "Às vezes", "Nunca"] },
                { text: "Qual estilo de armação você prefere?", options: ["Moderno e arrojado", "Clássico e elegante", "Esportivo", "Minimalista"] },
                { text: "Você pratica esportes regularmente?", options: ["Sim, esportes aquáticos", "Sim, esportes ao ar livre", "Sim, academia/indoor", "Não pratico"] },
                { text: "Qual sua prioridade na escolha das lentes?", options: ["Proteção UV", "Resistência a riscos", "Leveza", "Durabilidade"] },
                { text: "Você se incomoda com reflexos nas lentes?", options: ["Muito", "Moderadamente", "Pouco", "Não me incomodo"] }
            ],
            young_doesnt_use: [
                { text: "Você sente dificuldade para enxergar à distância?", options: ["Sim, muito", "Sim, um pouco", "Raramente", "Nunca"] },
                { text: "Você tem dores de cabeça frequentes?", options: ["Diariamente", "Algumas vezes por semana", "Raramente", "Nunca"] },
                { text: "Quanto tempo você passa em frente a telas?", options: ["Mais de 8 horas", "4-8 horas", "2-4 horas", "Menos de 2 horas"] },
                { text: "Você força os olhos para ler textos pequenos?", options: ["Sempre", "Frequentemente", "Às vezes", "Nunca"] },
                { text: "Qual seu estilo pessoal?", options: ["Moderno e tecnológico", "Clássico", "Casual", "Esportivo"] },
                { text: "Você trabalha muito ao ar livre?", options: ["Sim, sempre", "Frequentemente", "Às vezes", "Raramente"] },
                { text: "Você se preocupa com proteção solar nos olhos?", options: ["Muito", "Moderadamente", "Pouco", "Não me preocupo"] },
                { text: "Qual seria seu maior receio em usar óculos?", options: ["Mudança na aparência", "Desconforto", "Custo", "Manutenção"] }
            ],
            old_uses: [
                { text: "Há quanto tempo você usa óculos?", options: ["Mais de 20 anos", "10-20 anos", "5-10 anos", "Menos de 5 anos"] },
                { text: "Qual sua maior dificuldade visual atualmente?", options: ["Leitura de perto", "Visão à distância", "Visão noturna", "Transição claro/escuro"] },
                { text: "Você usa óculos multifocais?", options: ["Sim, e me adapto bem", "Sim, mas tenho dificuldades", "Não, mas gostaria de experimentar", "Não, prefiro óculos separados"] },
                { text: "Você sente os olhos secos com frequência?", options: ["Sempre", "Frequentemente", "Às vezes", "Nunca"] },
                { text: "Qual tipo de atividade você mais valoriza?", options: ["Leitura", "Trabalhos manuais", "Assistir TV", "Atividades ao ar livre"] },
                { text: "Você tem sensibilidade à luz?", options: ["Muito sensível", "Moderadamente sensível", "Pouco sensível", "Não tenho sensibilidade"] },
                { text: "Qual sua prioridade em lentes?", options: ["Conforto visual", "Facilidade de limpeza", "Durabilidade", "Estética"] },
                { text: "Você prefere armações:", options: ["Leves e discretas", "Robustas e seguras", "Elegantes e sofisticadas", "Práticas e funcionais"] }
            ],
            old_doesnt_use: [
                { text: "Você tem dificuldade para ler letras pequenas?", options: ["Sim, muita", "Sim, alguma", "Pouca", "Nenhuma"] },
                { text: "Você segura objetos longe para enxergar melhor?", options: ["Sempre", "Frequentemente", "Às vezes", "Nunca"] },
                { text: "Você sente cansaço visual ao ler?", options: ["Sempre", "Frequentemente", "Às vezes", "Nunca"] },
                { text: "Você tem histórico familiar de problemas visuais?", options: ["Sim, vários casos", "Sim, alguns casos", "Poucos casos", "Nenhum caso"] },
                { text: "Qual atividade você mais gostaria de melhorar?", options: ["Leitura", "Trabalhos detalhados", "Dirigir", "Assistir TV"] },
                { text: "Você evita atividades por dificuldade visual?", options: ["Sim, várias", "Sim, algumas", "Raramente", "Nunca"] },
                { text: "Como você se sente sobre usar óculos?", options: ["Totalmente aberto à ideia", "Curioso para experimentar", "Um pouco resistente", "Muito resistente"] },
                { text: "Qual seria sua maior preocupação?", options: ["Dependência dos óculos", "Aparência", "Conforto", "Custo"] }
            ]
        };

        // Função para renderizar baseada na configuração
        function render(config) {
            const companyName = config.company_name || defaultConfig.company_name;
            const consultantName = config.consultant_name || defaultConfig.consultant_name;
            const consultantGender = config.consultant_gender || defaultConfig.consultant_gender;
            const welcomeMessage = config.welcome_message || defaultConfig.welcome_message;
            const discountText = config.discount_text || defaultConfig.discount_text;

            // Definir pronome baseado no gênero
            const pronoun = consultantGender === 'female' ? 'sua consultora' : 'seu consultor';

            // Atualizar tela de abertura
            document.querySelector('.company-name').textContent = companyName;
            document.querySelector('.consultant-name').textContent = consultantName;
            document.querySelector('.consultant-intro').innerHTML =
                `Olá! Eu sou <span class="consultant-name">${consultantName}</span>, ${pronoun} virtual.<br>${welcomeMessage}`;

            // Atualizar outras telas
            if (document.querySelector('.quiz-title')) {
                document.querySelector('.quiz-title').textContent = `Quiz ${companyName}`;
            }
            if (document.querySelector('.welcome-message')) {
                document.querySelector('.welcome-message').textContent = "Descubra as lentes ideais para você em apenas 10 perguntas!";
            }
            if (document.querySelector('.discount-banner p')) {
                document.querySelector('.discount-banner p').textContent = discountText;
            }
        }

        // Inicializar o quiz
        function initQuiz() {
            currentQuestion = 0;
            answers = [];
            userProfile = { ageGroup: '', usesGlasses: '' };
            document.getElementById('questionContainer').style.display = 'block';
            document.getElementById('resultContainer').style.display = 'none';
            showQuestion();
        }

        // Mostrar pergunta atual
        function showQuestion() {
            const questionContainer = document.getElementById('questionContainer');
            questionContainer.classList.add('fade-in');

            updateProgress();

            let question;
            if (currentQuestion < 2) {
                question = fixedQuestions[currentQuestion];
            } else {
                const profileKey = `${userProfile.ageGroup}_${userProfile.usesGlasses}`;
                const conditionalIndex = currentQuestion - 2;
                const questionData = conditionalQuestions[profileKey][conditionalIndex];
                question = {
                    text: questionData.text,
                    options: questionData.options.map(opt => ({ text: opt, value: opt }))
                };
            }

            document.getElementById('questionNumber').textContent = `Pergunta ${currentQuestion + 1} de 10`;
            document.getElementById('questionText').textContent = question.text;

            const optionsContainer = document.getElementById('optionsContainer');
            optionsContainer.innerHTML = '';

            question.options.forEach((option, index) => {
                const button = document.createElement('button');
                button.className = 'option-button slide-in';
                button.style.animationDelay = `${index * 0.1}s`;
                button.innerHTML = colorirParenteses(option.text);
                button.onclick = () => selectOption(option);
                optionsContainer.appendChild(button);
            });
        }

        // Selecionar opção
        function selectOption(option) {
            const buttons = document.querySelectorAll('.option-button');
            buttons.forEach(btn => {
                if (btn.textContent === option.text) {
                    btn.classList.add('selected');
                }
            });

            // Armazenar resposta
            answers.push(option);

            // Definir perfil nas duas primeiras perguntas
            if (currentQuestion === 0) {
                userProfile.ageGroup = option.value;
            } else if (currentQuestion === 1) {
                userProfile.usesGlasses = option.value;
            }

            // Avançar após um breve delay
            setTimeout(() => {
                currentQuestion++;
                if (currentQuestion < 10) {
                    showQuestion();
                } else {
                    showResults();
                }
            }, 800);
        }

        // Atualizar barra de progresso
        function updateProgress() {
            const progress = ((currentQuestion + 1) / 10) * 100;
            document.getElementById('progressFill').style.width = `${progress}%`;
        }

        // Mostrar resultados
        function showResults() {
            document.getElementById('questionContainer').style.display = 'none';
            document.getElementById('resultContainer').style.display = 'block';
            document.getElementById('resultContainer').classList.add('fade-in');

            generateRecommendations();
        }

        // Sistema inteligente de análise de respostas
        function analyzeAnswers() {
            let score = {
                digitalStrain: 0,
                outdoorActivity: 0,
                readingNeed: 0,
                sensitivityLevel: 0,
                budgetLevel: 0,
                stylePreference: 0,
                durabilityNeed: 0,
                comfortPriority: 0
            };

            // Analisar cada resposta para calcular pontuações
            answers.forEach((answer, index) => {
                const answerText = answer.text.toLowerCase();

                // Análise de fadiga digital
                if (answerText.includes('computador') || answerText.includes('celular') || answerText.includes('8 horas')) {
                    score.digitalStrain += 3;
                } else if (answerText.includes('4-8 horas') || answerText.includes('tablet')) {
                    score.digitalStrain += 2;
                } else if (answerText.includes('2-4 horas')) {
                    score.digitalStrain += 1;
                }

                // Análise de atividades ao ar livre
                if (answerText.includes('ar livre') || answerText.includes('aquáticos') || answerText.includes('sempre')) {
                    score.outdoorActivity += 3;
                } else if (answerText.includes('frequentemente') || answerText.includes('outdoor')) {
                    score.outdoorActivity += 2;
                } else if (answerText.includes('às vezes')) {
                    score.outdoorActivity += 1;
                }

                // Análise de necessidade de leitura
                if (answerText.includes('leitura') || answerText.includes('perto') || answerText.includes('pequenos')) {
                    score.readingNeed += 3;
                } else if (answerText.includes('trabalhos') || answerText.includes('detalhados')) {
                    score.readingNeed += 2;
                }

                // Análise de sensibilidade
                if (answerText.includes('muito') && (answerText.includes('sensível') || answerText.includes('incomodo'))) {
                    score.sensitivityLevel += 3;
                } else if (answerText.includes('moderadamente') || answerText.includes('frequentemente')) {
                    score.sensitivityLevel += 2;
                } else if (answerText.includes('pouco') || answerText.includes('às vezes')) {
                    score.sensitivityLevel += 1;
                }

                // Análise de preferência de orçamento
                if (answerText.includes('premium') || answerText.includes('durabilidade') || answerText.includes('qualidade')) {
                    score.budgetLevel += 3;
                } else if (answerText.includes('moderado') || answerText.includes('equilibrio')) {
                    score.budgetLevel += 2;
                } else if (answerText.includes('básico') || answerText.includes('custo')) {
                    score.budgetLevel += 1;
                }

                // Análise de estilo
                if (answerText.includes('moderno') || answerText.includes('arrojado') || answerText.includes('tecnológico')) {
                    score.stylePreference += 3;
                } else if (answerText.includes('elegante') || answerText.includes('sofisticado')) {
                    score.stylePreference += 2;
                } else if (answerText.includes('clássico') || answerText.includes('discreto')) {
                    score.stylePreference += 1;
                }

                // Análise de necessidade de durabilidade
                if (answerText.includes('esportes') || answerText.includes('ativo') || answerText.includes('resistência')) {
                    score.durabilityNeed += 3;
                } else if (answerText.includes('trabalho') || answerText.includes('uso frequente')) {
                    score.durabilityNeed += 2;
                }

                // Análise de prioridade de conforto
                if (answerText.includes('conforto') || answerText.includes('leveza') || answerText.includes('adaptação')) {
                    score.comfortPriority += 3;
                } else if (answerText.includes('facilidade') || answerText.includes('prático')) {
                    score.comfortPriority += 2;
                }
            });

            return score;
        }

        // Gerar recomendações baseadas na análise inteligente
        function generateRecommendations() {
            const profileKey = `${userProfile.ageGroup}_${userProfile.usesGlasses}`;
            const analysis = analyzeAnswers();
            let recommendations = {};

            // Determinar categoria de lente baseada na análise
            let lensCategory = 'standard';
            if (analysis.digitalStrain >= 6) lensCategory = 'digital';
            if (analysis.readingNeed >= 6) lensCategory = 'reading';
            if (analysis.outdoorActivity >= 6) lensCategory = 'outdoor';
            if (analysis.sensitivityLevel >= 6) lensCategory = 'sensitive';

            // Determinar nível de qualidade baseado no orçamento e necessidades
            let qualityLevel = 'basic';
            if (analysis.budgetLevel >= 4 || analysis.durabilityNeed >= 4) qualityLevel = 'premium';
            else if (analysis.budgetLevel >= 2 || analysis.comfortPriority >= 4) qualityLevel = 'intermediate';

            // Gerar recomendações específicas baseadas no perfil e análise
            switch (profileKey) {
                case 'young_uses':
                    if (lensCategory === 'digital' && qualityLevel === 'premium') {
                        recommendations = {
                            lentes: "Zeiss BlueGuard Premium com filtro seletivo de luz azul-violeta (400-455nm) - Reduz 40% da luz azul nociva mantendo a percepção natural das cores",
                            tratamento: "Crizal Prevencia + Sapphire UV - Dupla proteção: anti-reflexo premium + filtro luz azul integrado. Resistência 25x superior a riscos",
                            espessura: "Índice 1.74 Zeiss ou Essilor - Lentes 60% mais finas que convencionais. Ideal para graus altos (-6.00 a -12.00)",
                            marcas: "🥇 Zeiss (Alemanha) - Tecnologia Carl Zeiss com 175 anos de inovação óptica | 🥈 Essilor (França) - Líder mundial em lentes oftálmicas"
                        };
                    } else if (lensCategory === 'digital' && qualityLevel === 'intermediate') {
                        recommendations = {
                            lentes: "Essilor EyeZen+ ou Hoya Sync III - Filtro luz azul + alívio de acomodação para uso prolongado de telas digitais",
                            tratamento: "Crizal Easy Pro ou Hoya Super HiVision - Anti-reflexo com proteção UV completa e facilidade de limpeza",
                            espessura: "Índice 1.67 - Equilíbrio perfeito entre finura, peso e custo. Reduz 40% da espessura vs lentes convencionais",
                            marcas: "🥇 Essilor EyeZen - Especialista em fadiga visual digital | 🥈 Hoya Sync - Tecnologia japonesa de precisão"
                        };
                    } else {
                        recommendations = {
                            lentes: "Hoya BlueControl ou Essilor Crizal Prevencia - Proteção básica contra luz azul com excelente custo-benefício",
                            tratamento: "Crizal Easy UV ou Hoya HiVision LongLife - Proteção UV 100% + anti-reflexo durável",
                            espessura: "Índice 1.60 - Lentes 25% mais finas com ótima relação custo x benefício para graus baixos a médios",
                            marcas: "🥇 Hoya (Japão) - Qualidade japonesa acessível | 🥈 Essilor Orma - Linha econômica premium"
                        };
                    }
                    break;

                case 'young_doesnt_use':
                    if (analysis.digitalStrain >= 4) {
                        recommendations = {
                            lentes: "Zeiss Digital Lens ou Essilor Computer - Lentes específicas para prevenção de fadiga digital mesmo sem grau",
                            tratamento: "Crizal Prevencia ou Zeiss BlueProtect - Filtro seletivo de luz azul mantendo cores naturais",
                            espessura: "Índice 1.56 CR-39 - Material clássico com excelente qualidade óptica e durabilidade comprovada",
                            marcas: "🥇 Zeiss Digital - Tecnologia alemã para era digital | 🥈 Essilor Computer - Especialista em conforto visual"
                        };
                    } else if (analysis.outdoorActivity >= 4) {
                        recommendations = {
                            lentes: "Transitions Signature GEN8 ou Zeiss PhotoFusion X - Lentes fotossensíveis de última geração",
                            tratamento: "Crizal Rock ou Zeiss DuraVision Platinum - Máxima resistência a riscos e impactos",
                            espessura: "Índice 1.60 Policarbonato - Material ultra-resistente, 10x mais resistente que lentes convencionais",
                            marcas: "🥇 Transitions (EUA) - Líder mundial em lentes fotossensíveis | 🥈 Zeiss PhotoFusion - Tecnologia alemã premium"
                        };
                    } else {
                        recommendations = {
                            lentes: "Essilor Orma ou Hoya Hilux - Lentes básicas de alta qualidade para proteção preventiva",
                            tratamento: "Crizal Easy ou Hoya HiVision - Proteção UV básica com anti-reflexo essencial",
                            espessura: "Índice 1.56 - Padrão internacional com excelente qualidade óptica e preço acessível",
                            marcas: "🥇 Essilor Orma - Qualidade francesa acessível | 🥈 Hoya Hilux - Confiabilidade japonesa"
                        };
                    }
                    break;

                case 'old_uses':
                    if (qualityLevel === 'premium') {
                        recommendations = {
                            lentes: "Varilux X Series ou Zeiss SmartLife Individual - Multifocais personalizadas com tecnologia de ponta",
                            tratamento: "Crizal Sapphire 360° ou Zeiss DuraVision Platinum - Proteção 360° com clareza cristalina",
                            espessura: "Índice 1.74 - Lentes ultrafinas para máximo conforto estético em multifocais",
                            marcas: "🥇 Varilux (Essilor) - Inventor das lentes progressivas há 60 anos | 🥈 Zeiss Individual - Personalização alemã premium"
                        };
                    } else if (qualityLevel === 'intermediate') {
                        recommendations = {
                            lentes: "Varilux Comfort Max ou Zeiss Precision Pure - Multifocais com adaptação facilitada",
                            tratamento: "Crizal Forte UV ou Zeiss DuraVision Silver - Durabilidade superior com proteção completa",
                            espessura: "Índice 1.67 - Redução significativa de peso e espessura para uso confortável prolongado",
                            marcas: "🥇 Varilux Comfort - Adaptação suave garantida | 🥈 Zeiss Precision - Tecnologia alemã acessível"
                        };
                    } else {
                        recommendations = {
                            lentes: "Varilux Liberty ou Hoya Balanço - Multifocais básicas com qualidade comprovada",
                            tratamento: "Crizal Easy Pro ou Hoya Super HiVision - Proteção essencial com facilidade de limpeza",
                            espessura: "Índice 1.60 - Equilíbrio ideal entre qualidade óptica e custo para multifocais",
                            marcas: "🥇 Varilux Liberty - Entrada premium no mundo multifocal | 🥈 Hoya Balanço - Qualidade japonesa acessível"
                        };
                    }
                    break;

                case 'old_doesnt_use':
                    if (analysis.readingNeed >= 6) {
                        recommendations = {
                            lentes: "Essilor Eyezen Start+ ou Zeiss OfficeLife - Lentes de apoio para presbiopia inicial com suporte acomodativo",
                            tratamento: "Transitions Signature ou Zeiss PhotoFusion - Adaptação automática à luminosidade para máximo conforto",
                            espessura: "Índice 1.60 - Otimizado para adaptação gradual com excelente qualidade óptica",
                            marcas: "🥇 Essilor Eyezen - Especialista em presbiopia inicial | 🥈 Zeiss Office - Conforto visual alemão"
                        };
                    } else {
                        recommendations = {
                            lentes: "Essilor Single Vision ou Hoya Hilux - Lentes monofocais básicas para adaptação suave",
                            tratamento: "Crizal Easy ou Hoya HiVision - Proteção UV essencial com anti-reflexo básico",
                            espessura: "Índice 1.56 - Padrão clássico com adaptação facilitada e custo acessível",
                            marcas: "🥇 Essilor Single - Qualidade francesa confiável | 🥈 Hoya Basic - Entrada suave no mundo dos óculos"
                        };
                    }
                    break;
            }

            // Adicionar recomendação personalizada baseada na análise
            let personalizedTip = "";
            if (analysis.digitalStrain >= 6) {
                personalizedTip = "💡 Dica Personalizada: Suas respostas indicam alto uso de dispositivos digitais. Recomendamos pausas de 20 segundos a cada 20 minutos olhando para algo a 20 metros de distância (regra 20-20-20).";
            } else if (analysis.outdoorActivity >= 6) {
                personalizedTip = "💡 Dica Personalizada: Seu perfil ativo requer proteção UV superior. Considere lentes com proteção UV 400 e tratamento hidrofóbico para facilitar a limpeza.";
            } else if (analysis.readingNeed >= 6) {
                personalizedTip = "💡 Dica Personalizada: Para atividades de leitura prolongada, recomendamos iluminação adequada (500-1000 lux) e posicionamento da leitura a 35-40cm dos olhos.";
            } else if (analysis.sensitivityLevel >= 6) {
                personalizedTip = "💡 Dica Personalizada: Sua sensibilidade à luz pode ser aliviada com lentes fotossensíveis que se adaptam automaticamente às condições de luminosidade.";
            }

            const content = document.getElementById('recommendationsContent');
            content.innerHTML = `
                <div style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; padding: 20px; border-radius: 12px; margin-bottom: 20px;">
                    <h3 style="margin: 0 0 10px 0; font-size: 1.3rem;">🎯 Esse foi o resultado que mais se encaixa com o seu perfil!</h3>
                    <p style="margin: 0; opacity: 0.9;">Análise inteligente baseada em ${answers.length} respostas personalizadas</p>
                </div>
                
                ${personalizedTip ? `<div style="background: #2d3748; border-left: 4px solid #667eea; padding: 15px; margin-bottom: 20px; border-radius: 8px;">
                    <p style="margin: 0; color: #cbd5e0; font-size: 0.95rem;">${personalizedTip}</p>
                </div>` : ''}
                
                <div class="recommendation-card">
                    <div class="recommendation-title">🔍 Lentes Recomendadas</div>
                    <div class="recommendation-text">${recommendations.lentes}</div>
                </div>
                <div class="recommendation-card">
                    <div class="recommendation-title">✨ Tratamentos Premium</div>
                    <div class="recommendation-text">${recommendations.tratamento}</div>
                </div>
                <div class="recommendation-card">
                    <div class="recommendation-title">📏 Índice de Refração</div>
                    <div class="recommendation-text">${recommendations.espessura}</div>
                </div>
                <div class="recommendation-card">
                    <div class="recommendation-title">🏆 Marcas Recomendadas</div>
                    <div class="recommendation-text">${recommendations.marcas}</div>
                </div>
            `;
        }

        // Iniciar quiz (transição da tela de abertura)
        function startQuiz() {
            document.getElementById('introScreen').style.display = 'none';
            document.getElementById('quizContainer').style.display = 'block';
            document.getElementById('quizContainer').classList.add('fade-in');
            initQuiz();
        }

        // Compartilhar resultado
        function shareResult() {
            // Mostrar tela de sucesso com animação
            document.getElementById('resultContainer').style.display = 'none';
            document.getElementById('successScreen').style.display = 'block';
            document.getElementById('successScreen').classList.add('fade-in');

            // Tentar compartilhar nativamente
            if (navigator.share) {
                navigator.share({
                    title: 'Meu Resultado do Quiz Óticas CDO',
                    text: 'Descobri as lentes ideais para mim com a consultora virtual! Faça você também o quiz personalizado das Óticas CDO! 🤓✨',
                    url: window.location.href
                });
            } else {
                // Fallback para navegadores sem suporte ao Web Share API
                const text = 'Descobri as lentes ideais para mim no Quiz das Óticas CDO! 🤓✨ Faça você também!';
                navigator.clipboard.writeText(text).then(() => {
                    // Mostrar mensagem inline ao invés de alert
                    const successMsg = document.createElement('div');
                    successMsg.innerHTML = '📋 Texto copiado! Cole nas suas redes sociais.';
                    successMsg.style.cssText = 'background: #48bb78; color: white; padding: 10px; border-radius: 8px; margin: 10px 0; font-size: 0.9rem;';
                    document.getElementById('successScreen').appendChild(successMsg);
                    setTimeout(() => successMsg.remove(), 3000);
                });
            }
        }

        // Voltar aos resultados
        function backToResults() {
            document.getElementById('successScreen').style.display = 'none';
            document.getElementById('resultContainer').style.display = 'block';
        }

        // Reiniciar quiz
        function restartQuiz() {
            document.getElementById('resultContainer').style.display = 'none';
            document.getElementById('successScreen').style.display = 'none';
            document.getElementById('quizContainer').style.display = 'none';
            document.getElementById('introScreen').style.display = 'block';

            // Resetar estado
            currentQuestion = 0;
            answers = [];
            userProfile = { ageGroup: '', usesGlasses: '' };
        }

        // Função para colorir o texto entre parênteses em azul
        function colorirParenteses(texto) {
            return texto.replace(/\(([^)]+)\)/g, '<span style="color: #00aaff;">($1)</span>');
        }

        // Configuração do Element SDK
        const element = {
            defaultConfig,
            render,
            mapToCapabilities: (config) => ({
                recolorables: [],
                borderables: [],
                fontEditable: undefined,
                fontSizeable: undefined
            }),
            mapToEditPanelValues: (config) => new Map([
                ["quiz_title", config.quiz_title || defaultConfig.quiz_title],
                ["welcome_message", config.welcome_message || defaultConfig.welcome_message],
                ["discount_text", config.discount_text || defaultConfig.discount_text]
            ])
        };

        // Inicializar quando a página carregar
        document.addEventListener('DOMContentLoaded', () => {
            if (window.elementSdk) {
                window.elementSdk.init(element);
            }
            render(defaultConfig);
            initQuiz();
        });
    </script>
    <script>(function () { function c() { var b = a.contentDocument || a.contentWindow.document; if (b) { var d = b.createElement('script'); d.innerHTML = "window.__CF$cv$params={r:'9923a0fb95e8f610',t:'MTc2MTA3OTg0My4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);"; b.getElementsByTagName('head')[0].appendChild(d) } } if (document.body) { var a = document.createElement('iframe'); a.height = 1; a.width = 1; a.style.position = 'absolute'; a.style.top = 0; a.style.left = 0; a.style.border = 'none'; a.style.visibility = 'hidden'; document.body.appendChild(a); if ('loading' !== document.readyState) c(); else if (window.addEventListener) document.addEventListener('DOMContentLoaded', c); else { var e = document.onreadystatechange || function () { }; document.onreadystatechange = function (b) { e(b); 'loading' !== document.readyState && (document.onreadystatechange = e, c()) } } } })();</script>
</body>

</html>